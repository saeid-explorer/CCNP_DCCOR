======================================================CCNP DCCOR==================================================

** VXLAN and VNI
  - There are some problems in traditional Data Centers
    - Vlans are limited (4K)
    - We have to use STP, FHRP, VPC which have their own problems
    - We have to use L3 PODs (L3 at edge) which are problematic

 - VXLAN helps us to better scale our network by two primary ways
    1) It will increase the number of Broadcast Domains that are available to us
    2) It's gonna extend L2 over L3

 - When we enable VXLAN on a switch, it's become known as VTEP(VXLAN Tunneling EndPoint)
 - One VLAN is going to be mapped to a single VNI(Virtual Network Identifier)
 - Then each VNI is going to be extended through a L3 boundary and connect to another VTEP which receives the 
   VNIs which has encapsulated the traffic that VXLAN enabled us to send.
 - Then the destination VTEP is going to translate VNI back into the individual VLANs that were originally
   connecting with.

 - VXLAN header is a 8 Byte header
    - 1B -> Flags
    - 3B -> VNI (almost 16Million VLANs)
    - 4B -> Reserved

  - Scoping the VNIs
    - There are two primary ways of scoping VNIs
      1) Network Scope
      2) Local Scope(locally significant VNI)
      
      - Network-wide scope means that if we were to apply a VNI to a particular VLAN, the question we're
        going to ask is whether this VNI is significant only to the local switch or to the entire Network.
      - Scoping Network-wide means that the specific VNI will also get mapped to the same Vlan on the
        destination VTEP
      - Benefit of Network-wide Scoping is that it's SIMPLE(i.e. VNI gonna point to the same VLAN in the
        entire Network)
      - Downside of Network-wide Scoping is Management. Because we have to be a worry about that the specific
        VNI is reserved everywhere and we can't repurpose that VNI by accident anywhere in the Network.


** VXLAN and Leaf-Spine
  - Leaf-Spine is only doable because we have VXLAN

  - Leaf-Spine Architecture
    - We have two layers: 1st layer is Spine and 2nd layer is Leaf
    - we connect every leaf switch to every upstream spine switch
      - we don't connect leaf-to-leaf or spine-to-spine(unline Aggregation-Access Architecture)
    - All of the Intelligence lives at the LEAF layer, not the Spine layer
    - The Spine switch has only one task: to bring traffic in and send back out which enables us to switch traffic
      between Leaf swtiches as fast as possible
    - Leaf-Spine is designed for scaling to very large L2 Fabric in the DataCenters today

  - Leaf-Spine Scaling
    1) we have Independent Scaling of different resources in the data center
        - we have a Backbone layer(Spine Layer) and if we want to increase our Bandwidth or PPS(Packets Per Second),
          we add new Spine Layer Switch
        - If we need Ports(additional connectivity at the Edge), we simply add Leaf switches
    2) Declaring Two-Hop behaviour for all Traffic in Data Center
        - When a packet arrives on a Leaf Switch, it's guaranteed that regardless of where it's heading in the Data Center,
          it's going to get there in precisely 2 Hops(first to Spine and then to the destination Leaf Swtich)

    3) Services
        - We can make our Network Services available very seamlessly throughout the Infrastructure
        - We bring our services(Network Load Balancers, Cloud Gateways, NGFW, AnyCast Gateways) into a pair of leaf switches


  - Application of VXLAN in Leaf-Spine Architecture
        - The ideal situation in Leaf-Spine Architecture is that the connections between Leaf to Spine to be L3(to be able
          to scale this architecture out) to be able to scale out. Otherwise in L2 connections STP gonna cause lot of problems
        - In this case, we can have two hosts on two different Leaf switches which are in the same VLAN. Then we can have these
          subnets stretched out(L2) because they are in the same VLAN and yet our Fabric is L3



** VXLAN Data Plane
    - VXLAN gonnna extend L2 over L3 using Encapsulation
    - The L2 Frame gonna come to source VTEP. Then it will be encapsulated into VXLAN Header
    - Then it will be encapsulated inside UDP Header which has Destination Port of 4789
    - Then It will be encapsulated into IP Header which has Source and Destination IP of Source and Destination VTEPs
    - Then it will send the Encapsulated packet over L3 to the destination VTEP
    - Destination VTEP gonna decapsulate it and get the packet
    - Fragmentaion is not supported by VXLAN
    - Remember increasing MTU


** VXLAN Control Plane - Flood and Learn
    - VXLAN lacks a native, dedicated Control Plane, instead it relies on Flood and Learn
    - Traffic is flooded via Multicast across the backbone to all VTEPs
    - Once a destination is learned, the ingress VTEP can forward as unicast
    * BUM(Broadcast, Unknown Unicast, Multicast) Traffic will be sent using  Multicast tree
    - IR(Ingress Replication) is where we have Unicast Backplane
      - it's an alternative method of control plane(for Multicast) which is rarely used
      - we have to manually map VNI to VTEP which takes lots of work
      - we gonna replicate lots of traffic
